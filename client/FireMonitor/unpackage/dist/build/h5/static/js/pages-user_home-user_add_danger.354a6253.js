(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-user_home-user_add_danger"],{"11bc":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var s={data:function(){return{class_picker_index:-1,class_picker:["11","22","33"],type_picker_index:-1,type_picker:["tt","tt2","tt3"],floor_picker_index:-1,floor_picker:["ff","ff2","ff3"],textareaDangerDescValue:"",imgList:[],reporter:"",floor:"",address:"",desc:"",modalName:null}},onLoad:function(){this.reporter=uni.getStorageSync("key_user_name")},methods:{classPickerChange:function(t){-1===this.class_picker_index?this.class_picker_index=0:this.class_picker_index=t.detail.value,this.checkBtnEnable()},typePickerChange:function(t){-1===this.type_picker_index?this.type_picker_index=0:this.type_picker_index=t.detail.value,this.checkBtnEnable()},textareaDangerDescInput:function(t){this.textareaDangerDescValue=t.detail.value},floorPickerChange:function(t){-1===this.floor_picker_index?this.floor_picker_index=0:this.floor_picker_index=t.detail.value,this.checkBtnEnable()},checkBtnEnable:function(){""==this.date||""==this.class_picker[this.class_picker_index]||void 0==this.class_picker[this.class_picker_index]||""==this.type_picker[this.type_picker_index]||void 0==this.type_picker[this.type_picker_index]||""==this.floor_picker[this.floor_picker_index]||void 0==this.floor_picker[this.floor_picker_index]?this.btn_disabled=!0:this.btn_disabled=!1},DelImg:function(t){var e=this;uni.showModal({title:"删除照片",content:"确定要删除这张照片吗？",cancelText:"否",confirmText:"是",success:function(i){i.confirm&&e.imgList.splice(t.currentTarget.dataset.index,1)}})},ChooseImage:function(){var t=this;uni.chooseImage({count:1,sizeType:["original","compressed"],sourceType:["album","camera"],success:function(e){0!=t.imgList.length?t.imgList=t.imgList.concat(e.tempFilePaths):t.imgList=e.tempFilePaths}})},successCallback:function(t){0===t.data.error&&(uni.hideLoading(),setTimeout(function(){uni.navigateBack({delta:1})},1500))},failCallback:function(t){uni.hideLoading(),console.log("api_add_danger failed",t)},completeCallback:function(t){},onAddDanger:function(){if(uni.showLoading({title:"上报中..."}),this.isEmpty(this.floor)||this.isEmpty(this.address)||this.isEmpty(this.desc))this.showToast("请正确填写信息");else{var t=Date.parse(new Date)/1e3,e={danger_create_user:this.reporter,danger_floor_level:this.floor,danger_address_detail:this.address,danger_desc:this.desc,danger_create_time:t};this.requestWithMethod(getApp().globalData.api_danger,"POST",e,this.successCallback,this.failCallback,this.completeCallback)}}}};e.default=s},"8b53":function(t,e,i){"use strict";var s,a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-uni-view",[i("cu-custom",{attrs:{bgColor:"bg-gradual-dark-purple",isBack:!0}},[i("template",{attrs:{slot:"content"},slot:"content"},[t._v("隐患上报")])],2),i("v-uni-view",{staticClass:"cu-card"},[i("v-uni-view",{staticClass:"cu-item"},[i("v-uni-view",{staticClass:"flex cu-form-group"},[i("v-uni-view",{staticClass:"title"},[t._v("上报人")]),i("v-uni-view",[t._v(t._s(t.reporter))])],1),i("v-uni-view",{staticClass:"cu-form-group"},[i("v-uni-view",{staticClass:"title"},[t._v("隐患楼层")]),i("v-uni-input",{staticClass:"text-right",attrs:{placeholder:"请输入隐患楼层",name:"input"},model:{value:t.floor,callback:function(e){t.floor=e},expression:"floor"}})],1),i("v-uni-view",{staticClass:"cu-form-group"},[i("v-uni-view",{staticClass:"title"},[t._v("具体位置")]),i("v-uni-input",{staticClass:"text-right",attrs:{placeholder:"请输入具体位置",name:"input"},model:{value:t.address,callback:function(e){t.address=e},expression:"address"}})],1),i("v-uni-view",{staticClass:"cu-form-group align-start"},[i("v-uni-view",{staticClass:"title"},[t._v("隐患描述")]),i("v-uni-textarea",{staticClass:"text-right",attrs:{maxlength:"-1",disabled:null!=t.modalName,placeholder:"请输入隐患描述"},on:{input:function(e){arguments[0]=e=t.$handleEvent(e),t.textareaDangerDescInput.apply(void 0,arguments)}},model:{value:t.desc,callback:function(e){t.desc=e},expression:"desc"}})],1),i("v-uni-view",{staticClass:"cu-bar bg-white margin-top solid-top"},[i("v-uni-view",{staticClass:"action"},[t._v("图片上传")]),i("v-uni-view",{staticClass:"action"},[t._v(t._s(t.imgList.length)+"/1")])],1),i("v-uni-view",{staticClass:"cu-form-group margin-bottom-sm"},[i("v-uni-view",{staticClass:"grid col-4 grid-square flex-sub"},[t._l(t.imgList,function(e,s){return i("v-uni-view",{key:s,staticClass:"bg-img",attrs:{"data-url":t.imgList[s]},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.ViewImage.apply(void 0,arguments)}}},[i("v-uni-image",{attrs:{src:t.imgList[s],mode:"aspectFill"}}),i("v-uni-view",{staticClass:"cu-tag bg-red",attrs:{"data-index":s},on:{click:function(e){e.stopPropagation(),arguments[0]=e=t.$handleEvent(e),t.DelImg.apply(void 0,arguments)}}},[i("v-uni-text",{staticClass:"cuIcon-close"})],1)],1)}),t.imgList.length<4?i("v-uni-view",{staticClass:"solids",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.ChooseImage.apply(void 0,arguments)}}},[i("v-uni-text",{staticClass:"cuIcon-cameraadd"})],1):t._e()],2)],1)],1),i("v-uni-view",{staticClass:"justify-between bottom-box"},[i("v-uni-view",{staticClass:"padding flex flex-direction"},[i("v-uni-button",{staticClass:"cu-btn bg-dark-purple lg",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.onAddDanger.apply(void 0,arguments)}}},[t._v("提交")])],1)],1)],1)],1)},n=[];i.d(e,"b",function(){return a}),i.d(e,"c",function(){return n}),i.d(e,"a",function(){return s})},ab51:function(t,e,i){"use strict";i.r(e);var s=i("11bc"),a=i.n(s);for(var n in s)"default"!==n&&function(t){i.d(e,t,function(){return s[t]})}(n);e["default"]=a.a},cdcb:function(t,e,i){"use strict";i.r(e);var s=i("8b53"),a=i("ab51");for(var n in a)"default"!==n&&function(t){i.d(e,t,function(){return a[t]})}(n);var c,r=i("f0c5"),l=Object(r["a"])(a["default"],s["b"],s["c"],!1,null,"ffa319a8",null,!1,s["a"],c);e["default"]=l.exports}}]);